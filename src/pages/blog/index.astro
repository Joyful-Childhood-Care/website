---
import { getCollection } from "astro:content";
import { Icon } from "astro-icon/components";
import Layout from '../../layouts/Layout.astro';
import ButtonGray from '../../components/UI/Button/Gray.astro';

let blog = await getCollection('blog', ({ data }) => {
  return import.meta.env.PROD ? data.draft !== true : true;
});
blog.sort((a, b) => b.data.date - a.data.date);
---

<Layout title="Blog">
  <h1>Blog</h1>

  {blog.map((b) => (
    <div class="max-w-3xl mx-auto my-8">
      <h2>{b.data.title}</h2>
      <div class="flex items-center gap-x-2">
        <Icon name="solar:calendar-minimalistic-bold" />
        <p class="font-semibold">{new Date(b.data.date).toDateString()}</p>
      </div>
      <div class="flex items-center gap-x-2">
        <Icon name="solar:user-rounded-bold" />
        <p class="font-semibold">{b.data.author}</p>
      </div>
      <p>{b.data.description}</p>
      <a href={`/blog/${b.slug}`}>
        <ButtonGray label="Read More" icon="solar:alt-arrow-right-bold" />
      </a>
    </div>
  ))}
</Layout>